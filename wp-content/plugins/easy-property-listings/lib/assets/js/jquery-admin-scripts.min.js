function epl_generate_inspection_markup(){var a;(new Date).getFullYear();return a='<div class="epl-added-inspection"></div><div id="epl-inspection-markup" class="epl-inspection-markup">',a+='<input type="text" style="width:6em;" autocomplete="off" id="epl-inspection-date" maxlength="2" size="2" placeholder="01"> ',a+=" From ",a+='<input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-start-hh" maxlength="2" size="2" placeholder="01">',a+=':<input type="text" autocomplete="off" id="epl-inspection-start-mm" maxlength="2" size="2" placeholder="01"> ',a+='<select id="epl-inspection-start-ampm" class="epl-inspection-ampm">',a+='<option value="AM">AM</option>',a+='<option value="PM">PM</option>',a+="</select>",a+=" | To ",a+='<input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-end-hh" maxlength="2" size="2" placeholder="01">',a+=':<input class="validate[custom[onlyNumber]]" type="text" autocomplete="off" id="epl-inspection-end-mm" maxlength="2" size="2" placeholder="01"> ',a+='<select id="epl-inspection-end-ampm" class="epl-inspection-ampm">',a+='<option value="AM">AM</option>',a+='<option value="PM">PM</option>',a+="</select>",a+='<a id="epl-inspection-add" class="button">Add</a></div>'}jQuery(document).ready(function(a){function b(a,b,c){c||(c=window.location.href);var d,e=new RegExp("([?&])"+a+"=.*?(&|#|$)(.*)","gi");if(e.test(c))return"undefined"!=typeof b&&null!==b?c.replace(e,"$1"+a+"="+b+"$2$3"):(d=c.split("#"),c=d[0].replace(e,"$1$3").replace(/(&|\?)$/,""),"undefined"!=typeof d[1]&&null!==d[1]&&(c+="#"+d[1]),c);if("undefined"!=typeof b&&null!==b){var f=-1!==c.indexOf("?")?"&":"?";return d=c.split("#"),c=d[0]+f+a+"="+b,"undefined"!=typeof d[1]&&null!==d[1]&&(c+="#"+d[1]),c}return c}function c(){var b=a(".epl-upgrade-btn").data("upgrade"),d=(a(".epl-upgrade-btn"),{action:"epl_upgrade_db",upgrade_to:b});a(".epl-ajax-notice").show(),a.ajax({method:"POST",url:ajaxurl,data:d,dataType:"json"}).done(function(b){if("success"==b.status){if(a(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-success").html(b.msg),"processing"==b.buffer)try{c()}catch(d){a(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html("Please reload page & process again.")}}else a(".epl-ajax-notice").removeClass(" ajax-fail ajax-success").addClass(" ajax-fail").html(b.msg)})}var d={init:function(){this.admin_listings_map(),d.manual_update(),this.mark_featured()},admin_listings_map:function(){if(0==a("#epl_admin_map_canvas").length)return!1;var b=a("#epl_admin_map_canvas").data("address"),c="";if(!window.google)return!1;""==b&&(b=epl_admin_vars.default_map_address);var d=new google.maps.Geocoder;d.geocode({address:b},function(b){c=b[0].geometry.location;var d=new google.maps.Map(document.getElementById("epl_admin_map_canvas"),{zoom:14,center:new google.maps.LatLng(c.lat().toString(),c.lng().toString()),mapTypeId:google.maps.MapTypeId.ROADMAP}),e=new google.maps.Marker({position:new google.maps.LatLng(c.lat().toString(),c.lng().toString()),draggable:!0});google.maps.event.addListener(e,"dragend",function(b){a("#property_address_coordinates").val(b.latLng.lat()+", "+b.latLng.lng())}),google.maps.event.addListener(e,"dragstart",function(a){}),d.setCenter(e.position),e.setMap(d)}),a(document.body).on("click",".epl-geocoder-button",function(){var b=a(this);b.closest("form").find("#property_address_sub_number").length?listingUnit=b.closest("form").find("#property_address_sub_number").val():b.closest("form").find("#property_address_lot_number").length?listingUnit=b.closest("form").find("#property_address_lot_number").val():listingUnit="";var c=listingUnit+" ",d=["property_address_street_number","property_address_street","property_address_suburb","property_address_state","property_address_postal_code","property_address_country"];a(d).each(function(a,d){b.closest("form").find("#"+d).length>0&&(c+=b.closest("form").find("#"+d).val()+" ")}),c=a.trim(c);var e="",f=new google.maps.Geocoder;f.geocode({address:c},function(b){e=b[0].geometry.location;var c=new google.maps.Map(document.getElementById("epl_admin_map_canvas"),{zoom:14,center:new google.maps.LatLng(e.lat().toString(),e.lng().toString()),mapTypeId:google.maps.MapTypeId.ROADMAP}),d=new google.maps.Marker({position:new google.maps.LatLng(e.lat().toString(),e.lng().toString()),draggable:!0});google.maps.event.addListener(d,"dragend",function(b){a("#property_address_coordinates").val(b.latLng.lat()+", "+b.latLng.lng())}),google.maps.event.addListener(d,"dragstart",function(a){}),a("#property_address_coordinates").val(e.lat().toString()+", "+e.lng().toString()),c.setCenter(d.position),d.setMap(c)})})},manual_update:function(){jQuery("#epl_manual_update_lookup").on("click",function(a){a.preventDefault();var b=window.location.href.split("?")[0],c=window.location.href.split("?")[1];if(null==c)var d=b+"?epl_manual_update=1";else var d=b+"?"+c+"&epl_manual_update=1";window.location.replace(d)})},mark_featured:function(){a(".column-property_featured span").on("click",function(b){var c=a(this),d=a(this).closest("tr").attr("id");d=d.split("-"),d=d[1],a.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"epl_update_featured_listing",id:d},success:function(a){c.toggleClass("dashicons-star-empty dashicons-star-filled"),"no"==a.featured?c.closest("tr").find(".epl-listing-labels .featured").remove():c.closest("tr").find(".epl-listing-labels").append('<li class="featured">Featured</li>')}})})}};d.init();if(a('input[name="epl_upload_button"]').length>0&&"undefined"!=typeof wp&&wp.media&&wp.media.editor&&a(document).on("click",'input[name="epl_upload_button"]',function(b){b.preventDefault();var c=a(this),d=c.prev();return wp.media.editor.send.attachment=function(a,b){console.log(b),d.val(b.url)},wp.media.editor.open(c),!1}),a(".dependency-true").each(function(){var b=a(this),c=b.attr("data-parent");if(a('select[name="'+c+'"]').length&&"taxonomy"==b.attr("data-type")){var d=b.attr("data-default");a('select[name="'+c+'"]').change(function(){a.ajax({type:"POST",url:ajaxurl,data:{parent_id:a(this).val(),type_name:b.attr("data-type-name"),type:b.attr("data-type"),default_value:d,action:"epl_get_terms_drop_list"},success:function(a){b.html(a)}})}).trigger("change")}}),a(".epldatepicker").length&&a(".epldatepicker").each(function(b){var c=a(this).data("timepicker"),d=a(this).data("format");console.log(d),c=1==c,a(this).epl_datetimepicker({timepicker:c,format:d})}),a("#property_auction").length&&a("#property_auction").epl_datetimepicker({format:"Y-m-d H:i",validateOnBlur:!1,onSelectTime:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onSelectDate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onGenerate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)}}),a("#property_sold_date").length&&a("#property_sold_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onSelectDate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onGenerate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)}}),a("#property_list_date").length&&a("#property_list_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onSelectDate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onGenerate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)}}),a("#property_com_lease_end_date").length&&a("#property_com_lease_end_date").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onSelectDate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onGenerate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)}}),a("#property_date_available").length&&a("#property_date_available").epl_datetimepicker({timepicker:!1,format:"Y-m-d",validateOnBlur:!1,onSelectTime:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onSelectDate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)},onGenerate:function(a,b){var c=b.val();c=c.replace(" ","T"),b.val(c)}}),a("#property_inspection_times").length){a("#property_inspection_times").hide();var e=a("#property_inspection_times").val();e=e.split("\n");var f=epl_generate_inspection_markup();f='<tr class="form-field"><td>'+f+"</td></tr>",a("#property_inspection_times").closest(".form-field").after(f),""!=a.trim(e)&&a.each(e,function(b,c){a(".epl-added-inspection").append('<span><span class="epl-inspection-text">'+c+'</span><span class="del-inspection-time">X</span></span>')}),jQuery("#epl-inspection-date").epl_datetimepicker({timepicker:!1,format:"d-M-Y",closeOnDateSelect:!0,allowBlank:!1}),jQuery("#epl-inspection-start-hh").epl_datetimepicker({datepicker:!1,format:"h",hours12:!0}),jQuery("#epl-inspection-start-mm").epl_datetimepicker({datepicker:!1,format:"i",allowTimes:["00:00","00:05","00:10","00:15","00:20","00:25","00:30","00:35","00:40","00:45","00:50","00:55"]}),jQuery("#epl-inspection-end-hh").epl_datetimepicker({datepicker:!1,format:"h",hours12:!0}),jQuery("#epl-inspection-end-mm").epl_datetimepicker({datepicker:!1,format:"i",allowTimes:["00:00","00:05","00:10","00:15","00:20","00:25","00:30","00:35","00:40","00:45","00:50","00:55"]})}jQuery("form").length&&jQuery("form").validationEngine(),a(document).on("click",".del-inspection-time",function(){var b=a(this).parent().find(".epl-inspection-text").text(),c=a("#property_inspection_times").val();c=c.split("\n"),c=jQuery.grep(c,function(a){return a!=b}),c=c.join("\n"),a("#property_inspection_times").val(c),a(this).parent().fadeOut(600,function(){a(this).remove()})}),a(document).on("click","#epl-inspection-add",function(b){b.preventDefault();var c=a("#epl-inspection-date").val()+" "+a("#epl-inspection-start-hh").val()+":"+a("#epl-inspection-start-mm").val()+a("#epl-inspection-start-ampm").val()+" to "+a("#epl-inspection-end-hh").val()+":"+a("#epl-inspection-end-mm").val()+a("#epl-inspection-end-ampm").val(),d=a("#property_inspection_times").val();if(d=d.split("\n"),-1==a.inArray(c,d)){d.push(c);var e=a('<span><span class="epl-inspection-text">'+c+'</span><span class="del-inspection-time">X</span></span>');d=d.join("\n"),a("#property_inspection_times").val(d),e.hide().appendTo(".epl-added-inspection").fadeIn(600)}}),a(".epl-price-bar").hover(function(){a(this).addClass("shine")},function(){a(this).removeClass("shine")}),jQuery(".epl-fields-tab-menu ul li").click(function(){var a=jQuery(this).attr("data-tab"),c=b("sub_tab",a);history.pushState("","",c),jQuery(".epl-fields-tab-menu ul li").removeClass("epl-fields-menu-current"),jQuery(".epl-fields-single-menu").removeClass("epl-fields-field-current"),jQuery(".epl-field-intro").removeClass("active epl-show-help"),jQuery('[data-help="'+a+'"]').addClass("active epl-show-help"),jQuery(this).addClass("epl-fields-menu-current"),console.log("#tab-menu-"+a),jQuery("#"+a).addClass("epl-fields-field-current")}),a(".epl-upgrade-btn").length&&a(".epl-upgrade-btn").on("click",function(a){a.preventDefault(),c()});var g={vars:{contact_card_wrap_editable:a(".epl-contact-card-wrapper .editable"),contact_card_wrap_edit_item:a(".epl-contact-card-wrapper .edit-item"),user_id:a('input[name="contactinfo[user_id]"]'),state_input:a(':input[name="contactinfo[state]"]'),note:a("#epl_contact_activity_content")},init:function(){this.edit_contact(),this.user_search(),this.remove_user(),this.cancel_edit(),this.change_country(),this.add_note(),this.add_note_note_tab(),this.add_listing(),this.delete_checked()},edit_contact:function(){a(document.body).on("click","#edit-contact",function(a){a.preventDefault(),g.vars.contact_card_wrap_editable.hide(),g.vars.contact_card_wrap_edit_item.fadeIn().css("display","block")})},user_search:function(){a(document.body).on("click.eplSelectUser",".epl_user_search_results a",function(b){b.preventDefault();var c=a(this).data("userid");g.vars.user_id.val(c)})},remove_user:function(){a(document.body).on("click","#disconnect-contact",function(b){b.preventDefault();var c=a('input[name="contactinfo[id]"]').val(),d={epl_action:"disconnect-userid",contact_id:c,_wpnonce:a("#edit-contact-info #_wpnonce").val()};a.post(ajaxurl,d,function(a){window.location.href=window.location.href},"json")})},cancel_edit:function(){a(document.body).on("click","#epl-edit-contact-cancel",function(b){b.preventDefault(),g.vars.contact_card_wrap_edit_item.hide(),g.vars.contact_card_wrap_editable.show(),a(".epl_user_search_results").html("")})},change_country:function(){a('select[name="contactinfo[country]"]').change(function(){var b=a(this);return data={action:"epl_get_shop_states",country:b.val(),field_name:"contactinfo[state]"},a.post(ajaxurl,data,function(a){"nostates"==a?g.vars.state_input.replaceWith('<input type="text" name="'+data.field_name+'" value="" class="epl-edit-toggles medium-text"/>'):g.vars.state_input.replaceWith(a)}),!1})},add_note_note_tab:function(){a(document.body).on("click","#add-contact-note",function(b){b.preventDefault();var c={epl_action:"add-contact-note-note-tab",contact_id:a("#epl-contact-id").val(),listing_id:a("#contact-note-listing").val(),activity_type:a("#contact-activity-type").val(),contact_note:a("#contact-note").val(),add_contact_note_nonce:a("#add_contact_note_nonce").val()};if(console.log(c),c.contact_note)a.ajax({type:"POST",data:c,url:ajaxurl,success:function(b){a("#epl-contact-notes").prepend(b),a(".epl-no-contact-notes").hide(),a("#contact-note").val("")}}).fail(function(a){window.console&&window.console.log&&console.log(a)});else{var d=g.vars.note.css("border-color");g.vars.note.css("border-color","red"),setTimeout(function(){g.vars.note.css("border-color",d)},500)}})},add_note:function(){a(document.body).on("click","#epl_contact_activity_submit",function(b){b.preventDefault();var c={epl_action:"add-contact-note",contact_id:a("#epl_contact_id").val(),listing_id:a("#epl_contact_activity_listing").val(),note_type:a("#epl_contact_activity_type").val(),contact_note:g.vars.note.val(),add_contact_note_nonce:a("#add_contact_note_nonce").val()};if(c.contact_note)a.ajax({type:"POST",data:c,url:ajaxurl,success:function(b){g.vars.note.val(""),a(".epl-contact-activities tbody").prepend(b)}}).fail(function(a){window.console&&window.console.log&&console.log(a)});else{var d=g.vars.note.css("border-color");g.vars.note.css("border-color","red"),setTimeout(function(){g.vars.note.css("border-color",d)},500)}})},add_listing:function(){a(document.body).on("click","#contact_listing_submit",function(b){b.preventDefault();var c=data=a("#epl_contact_add_listing_form").serialize();if(c+="&epl_action=add-contact-listing&contact_id="+a("#epl_contact_id").val())a.ajax({type:"POST",data:c,url:ajaxurl,success:function(b){g.vars.note.val(""),a(".epl-contact-listings tbody").prepend(b)}}).fail(function(a){window.console&&window.console.log&&console.log(a)});else{var d=g.vars.note.css("border-color");g.vars.note.css("border-color","red"),setTimeout(function(){g.vars.note.css("border-color",d)},500)}})},delete_checked:function(){a("#epl-contact-delete-confirm").change(function(){var b=a("#epl-contact-delete-records"),c=a("#epl-delete-contact");a(this).prop("checked")?(b.attr("disabled",!1),c.attr("disabled",!1)):(b.attr("disabled",!0),b.prop("checked",!1),c.attr("disabled",!0))})}};g.init(),a(".contact-action-category").on("click",function(a){a.preventDefault(),a.stopPropagation(),jQuery(".epl-contact_category_suggestions").slideToggle(100)}),a(".contact-action-tag").on("click",function(b){b.preventDefault(),b.stopPropagation(),jQuery(".epl-contact-tags-find").slideToggle(100),a("#contact-tag-hint").focus()}),a(document).on("click",function(b){a(".epl-contact_category_suggestions").is(":visible")&&jQuery(".epl-contact_category_suggestions").slideUp(100),a(".epl-contact-tags-find").is(":visible")&&!a(".epl-contact-tags-find > input").is(":focus")&&jQuery(".epl-contact-tags-find").slideUp(100)}),a(".epl-contact_category_suggestions > li >  a").on("click",function(b){b.preventDefault();var c=a(this).data("label");a.ajax({type:"POST",data:{action:"epl_contact_category_update",type:a(this).data("key"),contact_id:a("#epl_contact_id").val()},dataType:"json",url:ajaxurl,success:function(b){b&&a(".epl-contact-entry-header span").text(c)}})}),a(".epl-contact_tags_suggestions > li").on("click",function(b){b.preventDefault();var c={action:"contact_tags_update",contact_id:a("#epl_contact_id").val(),term_id:a(this).data("id"),bg:a(this).data("bg"),label:a(this).text()};return a("#contact-tag-"+c.term_id).length>=1?!1:void a.ajax({type:"POST",data:c,url:ajaxurl,success:function(b){if(a("#contact-tag-hint").val(""),a(".epl-contact_tags_suggestions > li").hide(),b){a("#contact-tag-hint").val("");var d='<li style="background:'+c.bg+'" data-id="'+c.term_id+'" id="contact-tag-'+c.term_id+'">'+c.label+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>';a(".epl-contact-assigned-tags").append(d)}}})}),a(".epl-contact-assigned-tags").on("click",".epl-contact-tag-del",function(b){b.preventDefault();var c=a(this),d={action:"epl_contact_tag_remove",contact_id:a("#epl_contact_id").val(),term_id:a(this).parent().data("id"),label:a(this).parent().text()};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(a){a&&c.parent().fadeIn(200).remove()}})}),a("#contact-tag-hint").keyup(function(b){var c=a(this).val();if(""==c)return!1;if(a(".epl-contact_tags_suggestions>li").each(function(){var b=a(this).text().toLowerCase();0==b.indexOf(c)?a(this).show():a(this).hide()}),13==b.keyCode){var d={action:"contact_tags_update",contact_id:a("#epl_contact_id").val(),term_id:c,bg:"#39b54a",label:c.charAt(0).toUpperCase()+c.slice(1)};if(a("#contact-tag-"+epl.helpers.string_to_name(d.term_id).length)>=1)return!1;a.ajax({type:"POST",data:d,url:ajaxurl,success:function(b){if(a("#contact-tag-hint").val(""),a(".epl-contact_tags_suggestions > li").hide(),b){a("#contact-tag-hint").val("");var c='<li style="background:'+d.bg+'" data-id="'+b+'" id="contact-tag-'+b+'">'+d.term_id+'<span class="dashicons dashicons-no epl-contact-tag-del"></span></li>';a(".epl-contact-assigned-tags").append(c),jQuery(".epl-contact-tags-find").slideUp(100)}}})}}),a(".epl-contact-add-activity").on("click",function(){var b="Add New"==a(".epl-contact-add-activity").text()?"Close":"Add New";a(".epl-contact-add-activity").text(b),a("#epl-contact-add-activity-wrap").slideToggle(100)}),a(".epl-contact-add-listing").on("click",function(){a("#epl-contact-add-listing-wrap").slideToggle(100)}),a(".epl-contact-addable:last").after('<span class="epl-contact-add-new-num">add another</span>'),a(".epl-contact-addable-email:last").after('<span class="epl-contact-add-new-email">add another</span>'),a(document).on("click",".epl-contact-add-new-num",function(){var b=epl.helpers.get_unique_name("phone","contact_phones"),c='		<div class="epl-contact-new-num">			<input type="number" maxlength="60" class="epl-contact-sub" name="'+b+'">			<select id="epl-contact-sub-select" type="select" class="epl-contact-note-select" > 				<option value="phone">Phone</option>				<option value="mobile">Mobile</option>				<option value="office">Office</option>				<option value="home">Home</option>			</select>		</div>		';a(this).before(c)}),a(document).on("click",".epl-contact-add-new-email",function(){var b=epl.helpers.get_unique_name("email","contact_emails"),c='		<div class="epl-contact-new-email">			<input type="email" maxlength="60" class="epl-contact-sub" name="'+b+'">			<select id="epl-contact-sub-mail" type="select" class="epl-contact-note-select" > 				<option value="email">Email</option>				<option value="work">Work</option>				<option value="office">Office</option>				<option value="home">Home</option>			</select>		</div>		';a(this).before(c)}),1==jQuery(".epl-contact-view-more").length&&jQuery(".epl-contact-main-wrapper.left")[0].scrollHeight>=195&&jQuery(".epl-contact-view-more").css("display","block"),jQuery(".epl-contact-view-more").on("click",function(){var a=jQuery(this).closest(".epl-contact-main-wrapper.left").height();190>=a?(jQuery(this).closest(".epl-contact-main-wrapper.left").height("auto"),jQuery(this).css("position","relative").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View Less')):(jQuery(this).closest(".epl-contact-main-wrapper.left").height("190px"),jQuery(this).css("position","absolute").html('<span class="dashicons dashicons-arrow-right-alt epl-contact-icons"></span>View More')),console.log(a)}),a(document).on("click","#epl-contact-sub-select",function(){var b=epl.helpers.get_unique_name(a(this).val(),"contact_phones");a(this).prev().attr("name",b)}),a(document).on("click","#epl-contact-sub-mail",function(){var b=epl.helpers.get_unique_name(a(this).val(),"contact_emails");a(this).prev().attr("name",b)}),a("#epl-item-tables-wrapper").on("click","th",function(b){b.preventDefault();var c=a(this);a("#epl-contact-table-orderby").val(a(this).data("sort")),console.log(a("#epl-contact-table-orderby").val()),c.hasClass("epl-sorted-desc")?(c.addClass("epl-sorted-asc"),a("#epl-contact-table-order").val("ASC")):(a("#epl-contact-table-order").val("DESC"),c.addClass("epl-sorted-desc"));var d={action:"epl_contact_get_activity_table",contact:a("#epl_contact_id").val(),number:10,paged:1,orderby:a("#epl-contact-table-orderby").val(),order:a("#epl-contact-table-order").val()};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(b){b&&a("#epl-contact-activity-table-wrapper").html(b)}})}),a(document).on("click",".epl-contact-load-activities",function(b){var c=a(this).data("page"),d={action:"epl_contact_get_activity_table",contact:a("#epl_contact_id").val(),number:10,paged:c,orderby:a("#epl-contact-table-orderby").val(),order:a("#epl-contact-table-order").val()};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(b){if(0!=b){var c=a(b).find("tbody").html(),d=a(b).find(".epl-contact-load-activities").data("page");a("#epl-contact-activity-table-wrapper").find("tbody").append(c),a(".epl-contact-load-activities").data("page",d)}}})});var h={init:function(){this.date_options()},date_options:function(){a("#epl-graphs-date-options").change(function(){var b=a(this),c=a("#epl-date-range-options");"other"===b.val()?c.show():c.hide()})}};if(h.init(),1==a("#property_owner").length){var i=null;a("#property_owner").keyup(function(){if(""==a("#property_owner").val())return a(".epl-contact-listing-suggestion").fadeOut(),!1;null!=i&&clearTimeout(i);var b=a(this).val();data={action:"epl_search_contact",user_name:b},i=setTimeout(function(){i=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){1==a(".epl-contact-listing-suggestion").length?a(".epl-contact-listing-suggestion").replaceWith(b):a("#property_owner").after(b),a(".epl-contact-listing-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-contact-listing-suggestion li",function(b){a("#property_owner").val(a(this).data("id")),a(".epl-contact-listing-suggestion").fadeOut()})}if(1==a("#epl_contact_wp_user").length){var j=null;a("#epl_contact_wp_user").keyup(function(b){var c=b.currentTarget;if(document.body.style.cursor="progress",""==a(c).val())return a(".epl-contact-user-suggestion").fadeOut(),!1;null!=j&&clearTimeout(j);var d=a(this).val();data={action:"epl_search_user",user_name:d},j=setTimeout(function(){j=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){document.body.style.cursor="auto",1==a(".epl-contact-user-suggestion").length?a(".epl-contact-user-suggestion").replaceWith(b):a(c).after(b),a(".epl-contact-user-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-contact-user-suggestion li",function(b){a("#epl_contact_wp_user").val(a(this).text()),a("#epl_contact_wp_user_id").val(a(this).data("id")),a(".epl-contact-user-suggestion").fadeOut()})}if(a(".epl-widget-author-username").length>0){var j=null;a(".epl-widget-author-username").keyup(function(b){var c=b.currentTarget;if(document.body.style.cursor="progress",""==a(c).val())return a(".epl-contact-user-suggestion").fadeOut(),!1;null!=j&&clearTimeout(j);var d=a(this).val();d=d.split(","),d=d[d.length-1],data={action:"epl_search_user",user_name:d,exclude_roles:"subscriber"},j=setTimeout(function(){j=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){document.body.style.cursor="auto",1==a(".epl-contact-user-suggestion").length?a(".epl-contact-user-suggestion").replaceWith(b):a(c).after(b),a(".epl-contact-user-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-contact-user-suggestion li",function(b){var c=a(this).closest(".epl-contact-user-suggestion").prev(),d=c.val();curr_val_arr=d.split(","),curr_val_arr.splice(-1,1),d=curr_val_arr.join(","),d=""==d?a(this).data("uname")+",":d+","+a(this).data("uname")+",",c.val(d),a(".epl-contact-user-suggestion").fadeOut().remove()})}if(1==a("#property_second_agent").length||1==a("#property_agent").length){var j=null;a("#property_second_agent,#property_agent").keyup(function(b){var c=b.currentTarget;if(document.body.style.cursor="progress",""==a(c).val())return a(".epl-contact-user-suggestion").fadeOut(),!1;null!=j&&clearTimeout(j);var d=a(this).val();data={action:"epl_search_user",user_name:d},j=setTimeout(function(){j=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){document.body.style.cursor="auto",1==a(".epl-contact-user-suggestion").length?a(".epl-contact-user-suggestion").replaceWith(b):a(c).after(b),a(".epl-contact-user-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-contact-user-suggestion li",function(b){a(this).closest(".epl-contact-user-suggestion").prev().val(a(this).data("uname")),a(".epl-contact-user-suggestion").fadeOut().remove()})}if(1==a("#epl_contact_listing_search").length){var k=null;a("#epl_contact_listing_search").keyup(function(){if(""==a("#epl_contact_listing_search").val())return a(".epl-contact-owned-listing-suggestion").fadeOut(),!1;null!=k&&clearTimeout(k);var b=a(this).val();data={action:"epl_search_contact_listing",s:b,contact:a("#epl_contact_id").val()},k=setTimeout(function(){k=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){1==a(".epl-contact-owned-listing-suggestion").length?a(".epl-contact-owned-listing-suggestion").replaceWith(b):a("#epl_contact_listing_search").after(b),a(".epl-contact-owned-listing-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-contact-owned-listing-suggestion li",function(b){var c=a(this).data("id");a.ajax({type:"POST",data:{epl_action:"add-existing-contact-listing",contact_id:a("#epl_contact_id").val(),id:c},url:ajaxurl,success:function(b){a(".epl-contact-listings tbody").prepend(b),a(".epl-contact-owned-listing-suggestion").fadeOut(),a("#epl_contact_listing_search").val("")}})})}a(document.body).on("click.eplSelectUser",".epl_user_search_results span a",function(b){b.preventDefault();var c=a(this).data("login");a(".epl-ajax-user-search").val(c),a(".epl_user_search_results").addClass("hidden"),a(".epl_user_search_results span").html("")}),a(document.body).on("click.eplCancelUserSearch",".epl_user_search_results a.epl-ajax-user-cancel",function(b){b.preventDefault(),a(".epl-ajax-user-search").val(""),a(".epl_user_search_results").addClass("hidden"),a(".epl_user_search_results span").html("")}),a("#epl-contact-add-listing-wrap").on("blur","input",function(b){var c="";c+=""!=a("#property_address_lot_number").val()?a("#property_address_lot_number").val()+"/":"",c+=""!=a("#property_address_sub_number").val()?a("#property_address_sub_number").val()+" ":"",c+=""!=a("#property_address_street_number").val()?a("#property_address_street_number").val()+" ":"",c+=""!=a("#property_address_street").val()?a("#property_address_street").val()+" ":"",c+=""!=a("#property_address_suburb").val()?a("#property_address_suburb").val()+" ":"",c+=""!=a("#property_address_state").val()?a("#property_address_state").val()+" ":"",c+=""!=a("#property_address_postal_code").val()?a("#property_address_postal_code").val()+" ":"",c+=""!=a("#property_address_country").val()?a("#property_address_country").val()+" ":"",a("#post_title").val(c)}),a(document).on("change",".epl_contact_type_filter",function(c){var d=a(this).val();""!=d&&(document.location.href=b("cat_filter",d))}),a(".epl-contact-list-table-tags").on("click",".epl-contact-assigned-tags li",function(c){var d=a(this).data("id");""!=d&&(document.location.href=b("tag_filter",d))}),a(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseleave",function(b){return a(this).parent().hasClass("epl-lock")?!1:void a(this).css({background:"#fff",color:a(this).data("accent")})}),a(".epl-contact-all-tags-container > span .epl-tag-btn").on("mouseenter",function(b){return a(this).parent().hasClass("epl-lock")?!1:void a(this).css({background:a(this).data("accent"),color:"#fff"})}),a(document.body).on("click",".epl-contact-all-tags-container > span .epl-tag-btn",function(b){if(par=a(this).parent(),b.preventDefault(),a(this).parent().hasClass("epl-lock"))return!1;par.siblings().removeClass("epl-lock").find(".epl-popup-box").remove(),par.siblings().find(".epl-tag-btn").trigger("mouseleave"),par.toggleClass("epl-lock");var c='<div class="epl-popup-box epl-all-tags-single-tag">\n    <span class="epl-single-tag-name">\n        <input type="text" id="epl-single-tag-name-input">\n    </span>\n    <ul class="epl-colors-list" >\n        <li class="epl-color-gray" data-color="#d2d2d2"><b></b></li>\n        <li class="epl-color-green" data-color="#43ac6d"><b></b></li>\n        <li class="epl-color-blue" data-color="#459bc4"><b></b></li>\n        <li class="epl-color-orange" data-color="#f9845b"><b></b></li>\n        <li class="epl-color-purple" data-color="#7d669e"><b></b></li>\n        <li class="epl-color-red" data-color="#ed5a5a"><b></b></li>\n        <li class="epl-color-yellow" data-color="#ecc33f"><b></b></li>\n    </ul>\n    <div class="epl-single-tag-opts">\n        <span data-action="filter" title="Filter" class="dashicons dashicons-filter"></span>\n        <span data-action="delete" title="Trash" class="dashicons dashicons-trash"></span>\n    </div>\n</div>';1!=a(this).find(".epl-popup-box").length&&a(c).appendTo(par).slideDown()});var l={init:function(){this.update_bg(),this.update_name(),this["delete"](),this.filter()},update_bg:function(){a(document.body).on("click",".epl-all-tags-single-tag .epl-colors-list  li",function(b){b.preventDefault();var c=a(this);a(this).siblings().removeClass("active"),a(this).addClass("active");var d={action:"contact_tags_update",term_id:a(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),bg:a(this).data("color")};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(a){a&&(c.closest(".epl-lock").find(".epl-tag-btn").data("accent",c.data("color")),c.closest(".epl-lock").find(".epl-tag-btn").css("background",c.data("color")))}})})},update_name:function(){a(document.body).on("blur","#epl-single-tag-name-input",function(b){b.preventDefault();var c=a(this),d={action:"contact_tags_update",term_id:a(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),label:a(this).val()};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(a){a&&c.closest(".epl-lock").find(".epl-tag-btn").text(c.val())}})})},"delete":function(){a(document.body).on("click",".epl-single-tag-opts .dashicons-trash",function(b){b.preventDefault();var c=a(this),d={action:"contact_tags_update",term_id:a(this).closest(".epl-lock").find(".epl-tag-btn").data("id"),"delete":1};a.ajax({type:"POST",data:d,url:ajaxurl,success:function(a){a&&c.closest(".epl-lock").fadeOut().remove()}})})},filter:function(){a(document.body).on("click",".epl-single-tag-opts .dashicons-filter",function(b){b.preventDefault();var c=a(this).closest(".epl-lock").find(".epl-tag-btn").data("id");window.location.href="admin.php?page=epl-contacts&tag_filter="+c})}};l.init()});