function eplGetCookie(a){return EPL_Front_Js.get_cookie(a)}jQuery(document).ready(function(a){Number.prototype.formatMoney=function(a,b,c){var d=this,a=isNaN(a=Math.abs(a))?2:a,b=void 0==b?".":b,c=void 0==c?",":c,e=0>d?"-":"",f=parseInt(d=Math.abs(+d||0).toFixed(a))+"",g=(g=f.length)>3?g%3:0;return e+(g?f.substr(0,g)+c:"")+f.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+c)+(a?b+Math.abs(d-f).toFixed(a).slice(2):"")},EPL_Front_Js={init:function(){this.sort_listings(),this.author_tabs(),this.default_map(),this.switch_view(),this.set_default_view(),this.listing_search_tabs(),this.field_sliders(),this.epl_search(),this.contact_form_submit()},property_search:function(){if(1==a("#property_id").length){var b=null;a("#property_id").keyup(function(){if(""==a("#property_id").val())return a(".epl-property-suggestion").fadeOut(),!1;null!=b&&clearTimeout(b);var c=a(this).val();data={action:"epl_search_listing",s:c},b=setTimeout(function(){b=null,a.ajax({type:"POST",data:data,url:ajaxurl,success:function(b){1==a(".epl-property-suggestion").length?a(".epl-property-suggestion").replaceWith(b):a("#property_id").after(b),a(".epl-property-suggestion").fadeIn()}})},300)}),a(document.body).on("click",".epl-property-suggestion li",function(b){a("#property_id").val(a(this).data("id")),a(".epl-property-suggestion").fadeOut().remove()})}},sort_listings:function(){jQuery("#epl-sort-listings").on("change",function(){var a=jQuery(this).val(),b=window.location.href.split("?")[0],c=window.location.href.split("?")[1],d=b.search("page");if(d>-1)var b=b.substring(0,d);if(null!=jQuery.getUrlVar("sortby")){c="?"+c;var e=/([?&]sortby)=([^#&]*)/g;c=c.replace(e,"$1="+a);var f=b+c}else if(null==c)var f=b+"?sortby="+a;else var f=b+"?"+c+"&sortby="+a;window.location.replace(f)})},get_cookie:function(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return unescape(d)},author_tabs:function(){jQuery("ul.epl-author-tabs li").click(function(){var a=jQuery(this).closest(".epl-author-box-container").attr("id"),b=jQuery(this).attr("data-tab");jQuery("#"+a+" ul.epl-author-tabs li").removeClass("epl-author-current"),jQuery("#"+a+" .epl-author-tab-content").removeClass("epl-author-current"),jQuery(this).addClass("epl-author-current"),jQuery("#"+a+" #"+b).addClass("epl-author-current")})},default_map:function(){function b(){d=new google.maps.Geocoder,eplmapcord=new google.maps.LatLng(e[0],e[1]);var a={center:eplmapcord,zoom:g};window.epldefaultmap=new google.maps.Map(document.getElementById("epl-default-map"),a),epl_marker_icon="default.png",window.epldefaultmarker=new google.maps.Marker({map:epldefaultmap,position:eplmapcord,icon:epl_frontend_vars.image_base+epl_marker_icon})}function c(){d=new google.maps.Geocoder,d.geocode({address:f},function(b,c){if(c==google.maps.GeocoderStatus.OK){var d={center:b[0].geometry.location,zoom:g};epldefaultmap=new google.maps.Map(document.getElementById("epl-default-map"),d),epl_marker_icon="default.png",1!=i?a.ajax({type:"POST",url:epl_frontend_vars.ajaxurl,data:{action:"epl_update_listing_coordinates",coordinates:b[0].geometry.location.toString(),listid:h}}).done(function(a){}):epl_marker_icon="suburb.png",window.epldefaultmarker=new google.maps.Marker({map:epldefaultmap,position:b[0].geometry.location,icon:epl_frontend_vars.image_base+epl_marker_icon})}})}if(a("#epl-default-map").length&&"object"==typeof google&&"object"==typeof google.maps){var d,e=a("#epl-default-map").data("cord"),f=a("#epl-default-map").data("address"),g=a("#epl-default-map").data("zoom"),h=a("#epl-default-map").data("id"),i=a("#epl-default-map").data("suburb_mode");""!=e?(e=e.split(","),b()):""!=f&&c()}},set_default_view:function(){if(void 0!==eplGetCookie("preferredView")){var a=this.get_cookie("preferredView");jQuery('.epl-switch-view ul li[data-view="'+a+'"]').trigger("click")}else"grid"==epl_frontend_vars.epl_default_view_type&&jQuery('.epl-switch-view ul li[data-view="grid"]').trigger("click")},switch_view:function(){jQuery(".epl-switch-view ul li").click(function(){var b=jQuery(this).data("view");a.ajax({type:"POST",url:epl_frontend_vars.ajaxurl,data:{action:"epl_update_default_view",view:b}}).done(function(a){}),"undefined"==typeof listingsMasonEnabled&&(jQuery(".epl-switch-view ul li").removeClass("epl-current-view"),jQuery(this).addClass("epl-current-view"),"grid"==b?(jQuery(".epl-property-blog").addClass("epl-listing-grid-view"),jQuery(".epl-listing-grid-view.epl-property-blog").each(function(a){a+=1})):jQuery(".epl-property-blog").removeClass("epl-listing-grid-view"))})},listing_search_tabs:function(){jQuery("ul.property_search-tabs li").click(function(){var a=jQuery(this).attr("data-tab");jQuery("ul.property_search-tabs li").removeClass("epl-sb-current"),jQuery(".epl-search-form").removeClass("epl-sb-current"),jQuery(this).addClass("epl-sb-current"),jQuery("#"+a).addClass("epl-sb-current")})},get_url_vars:function(){for(var a,b=[],c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b},get_url_var:function(a){return this.get_url_vars()[a]},field_sliders:function(){var b=a(".epl-search-form"),c=epl_frontend_vars.field_sliders;b.each(function(b){var d=a(this);a.each(c,function(b,c){if(elExists=!0,a.each(c.els,function(b,c){a("."+c).length?a("."+c).closest(".epl-search-row").hide():elExists=!1}),elExists)if(c.els.length<2){var e=isNaN(Number(a("."+c.els[0]).data("min")))?c.min:Number(a("."+c.els[0]).data("min")),f=isNaN(Number(a("."+c.els[0]).data("max")))?c.max:Number(a("."+c.els[0]).data("max")),g=e,h=a.getUrlVar(c.els[0]);void 0!==h&&(g=parseInt(h)),a("."+c.els[0]).closest(".epl-search-row").after('<div class="epl-lf-range-slider epl-search-row epl-search-row-select fm-block epl-search-row-full "><label class="epl-search-label fm-label label_'+b+'" for="'+b+'">'+c.label+'</label><div class="field"><div class="'+b+'"></div></div></div>'),a("."+b).each(function(d){var h=a(this).closest(".epl-lf-range-slider");a(this).slider({min:e,max:f,range:"min",animate:!0,value:g,slide:function(d,e){a("."+c.els[0]).append(new Option(e.value.formatMoney(0),e.value)),a("."+c.els[0]).val(e.value).change(),h.find(".label_"+b).html(c.label+'<span class="epl-lf-label-txt"> '+c.prefix+e.value.formatMoney(0)+c.suffix+"</span>")},stop:function(a,b){},create:function(a,d){h.find(".label_"+b).html(c.label+'<span class="epl-lf-label-txt"> '+c.prefix+g.formatMoney(0)+c.suffix+"</span>")}})})}else{var i=d.find("."+c.els[0]),j=d.find("."+c.els[1]),g=[i.data("min"),i.data("max")],e=isNaN(Number(i.data("min")))?c.min:Number(i.data("min")),f=isNaN(Number(j.data("max")))?c.max:Number(j.data("max")),k=a.getUrlVar(c.els[0]),l=a.getUrlVar(c.els[1]);void 0!==k&&""!=k&&(k=parseInt(k)),void 0!==l&&""!=l&&(l=parseInt(l)),(void 0!==k&&""!=k||void 0!==l&&""!=l)&&(g=[k,l]),i.closest(".epl-search-row").after('<div class="epl-lf-range-slider epl-search-row epl-search-row-select fm-block epl-search-row-full "><label class="epl-search-label fm-label label_'+b+'" for="'+b+'">'+c.label+'</label><div class="field"><div class="'+b+'"></div></div></div>'),d.find("."+b).each(function(h){var k=a(this).closest(".epl-lf-range-slider");a(this).slider({range:!0,step:d.find("."+c.els[1]).has("option").length>0?Number(d.find("."+c.els[1]+" option:eq(2)").val())-Number(d.find("."+c.els[1]+" option:eq(1)").val()):c.step,min:e,max:f,animate:!0,values:g,slide:function(a,d){i.append(new Option(d.values[0].formatMoney(0),d.values[0])),i.append(new Option(d.values[1].formatMoney(0),d.values[1])),j.append(new Option(d.values[0].formatMoney(0),d.values[0])),j.append(new Option(d.values[1].formatMoney(0),d.values[1])),i.val(d.values[0]).change(),j.val(d.values[1]).change(),k.find(".label_"+b).html(c.label+'<span class="epl-lf-label-txt"> '+c.prefix+d.values[0].formatMoney(0)+c.suffix+c.seperator+c.prefix+d.values[1].formatMoney(0)+c.suffix+"</span>")},stop:function(a,b){},create:function(a,d){k.find(".label_"+b).html(c.label+'<span class="epl-lf-label-txt"> '+c.prefix+g[0].formatMoney(0)+c.suffix+c.seperator+c.prefix+g[1].formatMoney(0)+c.suffix+"</span>")}})})}})})},epl_search:function(){a(".epl-search-form form").on("submit",function(b){b.preventDefault();var c=a(this).serialize(),d=c.split("&"),e=[];for(i in d)d[i].split("=")[1]&&e.push(d[i]);var f=e.join("&"),g=epl_frontend_vars.site_url+"?"+f;location.href=g})},contact_form_submit:function(){a(".epl-contact-capture-form form").on("submit",function(b){var c=a(this);b.preventDefault();var d=a(this).serializeArray();d.push({name:"action",value:"epl_contact_capture_action"}),a.ajax({type:"POST",url:epl_frontend_vars.ajaxurl,data:d,dataType:"json"}).done(function(b){a(".epl-contact-widget-msgs").remove(),c.after('<div class="epl-contact-widget-msgs epl-contact-widget-msg-'+b.status+'">'+b.msg+"</div>"),"success"==b.status&&c.trigger("reset")})})}},EPL_Front_Js.init()}),jQuery.extend({getUrlVars:function(){return EPL_Front_Js.get_url_vars()},getUrlVar:function(a){return EPL_Front_Js.get_url_var(a)}});