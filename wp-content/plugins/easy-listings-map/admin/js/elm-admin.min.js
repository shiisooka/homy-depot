!function(a){"use strict";a(function(){var b={init:function(){this.general()},general:function(){if("undefined"==typeof wp)a(".elm_settings_upload_button").length>0&&(window.formfield="",a("body").on("click",".elm_settings_upload_button",function(b){b.preventDefault(),window.formfield=a(this).parent().prev(),window.tbframe_interval=setInterval(function(){jQuery("#TB_iframeContent").contents().find(".savesend .button").val(elm_vars.use_this_file).end().find("#insert-gallery, .wp-post-thumbnail").hide()},2e3),tb_show(elm_vars.add_new_download,"media-upload.php?referrer_page=elm-settings&TB_iframe=true")}),window.edd_send_to_editor=window.send_to_editor,window.send_to_editor=function(b){if(window.formfield){var c=a("a","<div>"+b+"</div>").attr("href");window.formfield.val(c),window.clearInterval(window.tbframe_interval),tb_remove()}else window.edd_send_to_editor(b);window.send_to_editor=window.edd_send_to_editor,window.formfield="",window.imagefield=!1});else{var b;window.formfield="",a("body").on("click",".elm_settings_upload_button",function(c){c.preventDefault();var d=a(this);return window.formfield=a(this).parent().prev(),b?void b.open():(b=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:d.data("uploader_title"),button:{text:d.data("uploader_button_text")},multiple:!1}),b.on("menu:render:default",function(a){var b={};a.unset("library-separator"),a.unset("gallery"),a.unset("featured-image"),a.unset("embed"),a.set(b)}),b.on("insert",function(){var a=b.state().get("selection");a.each(function(a,b){a=a.toJSON(),window.formfield.val(a.url)})}),b.on("ready",function(){b.uploader.options.uploader.params={referrer_page:"elm-settings"}}),void b.open())})}}};b.init(),jQuery(".help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200});var c={init:function(){this.subscribe()},subscribe:function(){a("#subscribe").on("click",function(b){var d=!1;jQuery.trim(jQuery("#name").val())?jQuery("#name").removeClass("error-field"):(jQuery("#name").addClass("error-field"),d=!0),c.validateEmail(a("#email").val())?jQuery("#email").removeClass("error-field"):(jQuery("#email").addClass("error-field"),d=!0),d||(c.showMessage("Please wait...",2),a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"send_subscribe_email",subscribe_nonce:elm_vars.subscribe_nonce,name:jQuery.trim(jQuery("#name").val()),email:a("#email").val()}}).done(function(a){c.showMessage(a.message,a.success)}).fail(function(a){c.showMessage("Some error occurred in subscription.",0)}))})},validateEmail:function(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},showMessage:function(a,b){jQuery("#subscribe-message").removeClass("message-success message-error message-info"),jQuery("#subscribe-message").html(""),jQuery("#subscribe-message").html(a),jQuery("#subscribe-message").show(),1==b?jQuery("#subscribe-message").addClass("message-success"):2==b?jQuery("#subscribe-message").addClass("message-info"):jQuery("#subscribe-message").addClass("message-error")}};c.init()})}(jQuery);
